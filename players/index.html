<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Player Stats ‚Äì Svenska eHockey Cupen</title>
  /* Loader wrapper (dold fr√•n start) */
.loader-wrapper {
  display: none;
  width: 100%;
  padding: 40px 0;
  display: flex;
  justify-content: center;
}

/* Sj√§lva loadern */
.loader {
  width: 55px;
  height: 55px;
  border: 6px solid rgba(255,215,0,0.15);
  border-top: 6px solid #f5d86e;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

/* Animation */
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

  <style>
    body {
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #0a0c11, #000);
      color: #e6edf3;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Header Card */
    .header-card {
      width: 95%;
      max-width: 1100px;
      background: rgba(20,20,28,0.8);
      padding: 40px;
      border-radius: 20px;
      border: 1px solid rgba(255,215,0,0.2);
      box-shadow: 0 0 25px rgba(255,215,0,0.15);
      text-align: center;
      margin-bottom: 25px;
    }

    .header-card img {
      width: 160px;
      margin-bottom: 20px;
    }

    #playerName {
      font-size: 2.2rem;
      font-weight: 700;
      letter-spacing: 2px;
      color: #f5d86e;
      text-shadow: 0 0 10px rgba(255,215,0,0.4);
    }

    #playerPhoto {
      width: 260px;
      height: auto;
      border-radius: 20px;
      object-fit: contain;
      background:#0a0c11;
      padding: 6px;
      opacity: 1;
      box-shadow: 0 0 35px rgba(255,215,0,0.25);
      border: 2px solid rgba(255,215,0,0.35);
    }

    #playerPhoto.loaded {
      opacity: 1;
    }

    /* Player Card */
    .player-card {
      width: 95%;
      max-width: 900px;
      background: linear-gradient(180deg, #0d1020 0%, #05060a 100%);
      padding: 40px 30px;
      border-radius: 20px;
      border: 1px solid rgba(255,215,0,0.20);
      box-shadow: 0 0 40px rgba(255,215,0,0.10);
      text-align: center;
      margin-bottom: 35px;
    }

    /* Stats Table */
    .stats-table table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 0.95rem;
    }

    .stats-table th {
      color: #f5d86e;
      padding: 10px 5px;
      border-bottom: 1px solid rgba(255,215,0,0.25);
      text-align: left;
    }

    .stats-table td {
      padding: 10px 5px;
      border-bottom: 1px solid #232832;
      color: #e6edf3;
    }

    .stats-table tr:last-child td {
      border-bottom: none;
    }

    .no-stats {
      background: #3a0000;
      border: 1px solid #ff4d4d;
      padding: 10px 15px;
      border-radius: 10px;
      color: #ffb3b3;
      font-weight: bold;
      margin-top: 15px;
    }

    /* Navigation pill */
    .sec-nav-wrapper {
      width: 95%;
      max-width: 900px;
      margin-bottom: 25px;
      text-align: center;
    }

    .sec-nav-pill {
      background: rgba(20,20,28,0.8);
      padding: 12px 30px;
      border-radius: 14px;
      border: 1px solid rgba(255,215,0,0.25);
      display: inline-block;
      box-shadow: 0 0 18px rgba(255,215,0,0.12);
      font-weight: 600;
      letter-spacing: 1px;
      color: #f5d86e;
    }

    @media (max-width: 600px) {
      #playerPhoto {
        width: 200px;
      }

      #playerName {
        font-size: 1.6rem;
      }
    }
    /* ====== Statistik-tabell ‚Äì SWEeHockey ====== */

.stats-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 15px;
}

/* Header */
.stats-table th {
    padding: 10px 12px;
    background: #111;
    color: #f5c851;
    font-weight: 700;
    border-bottom: 2px solid #222;
}

/* Rader */
.stats-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #222;
    color: #ddd;
}

/* Hover-effekt */
.stats-table tr:hover {
    background: rgba(255, 255, 255, 0.06);
}

/* V√§nsterst√§ll TURNERING och TEAM */
.stats-table th:nth-child(1),
.stats-table td:nth-child(1),
.stats-table th:nth-child(2),
.stats-table td:nth-child(2) {
    text-align: left;
}

/* Centrera √∂vriga kolumner */
.stats-table th:nth-child(n+3),
.stats-table td:nth-child(n+3) {
    text-align: center;
}

/* Lite extra spacing f√∂r TEAM-kolumnen */
.stats-table td:nth-child(2) {
    padding-left: 18px;
}

/* ====== MOBILANPASSNING ====== */
@media (max-width: 650px) {
    .stats-table {
        font-size: 13px;
    }

    .stats-table th,
    .stats-table td {
        padding: 8px 6px;
    }

    /* TEAM f√•r mindre padding p√• mobil */
    .stats-table td:nth-child(2) {
        padding-left: 10px;
    }
}

  </style>
</head>
<body>

  <!-- SEC HEADER -->
  <div class="header-card">
    <img src="https://drive.google.com/thumbnail?id=1QybW_Uw8HO0OXo8vwQFD-zrrr-ifFrC9&sz=w1000" alt="SEC Logo" />
    <h1 style="font-size:1.8rem; font-weight:700; color:#f5d86e; letter-spacing:1px; margin-top:10px; text-shadow:0 0 10px rgba(255,215,0,0.4);">
      üèÜ SVENSKA EHOCKEY CUPEN jddj üèí
    </h1>
  </div>

  <!-- NAVIGATION -->
  <div class="sec-nav-wrapper">
    <div class="sec-nav-pill">SPELARKORT</div>
  </div>

  <!-- PLAYER CARD -->
  <div class="player-card">
    <img id="playerPhoto" alt="Spelarbild" />
    <div id="playerName" style="margin-top:18px;"></div>

    <h2 style="margin-top:10px;color:#f5d86e;font-size:1.4rem;letter-spacing:1px;">
      STATISTIK ‚Äì SVENSKA EHOCKEY CUPEN
    </h2>
    <p style="color:#ccc;max-width:600px;margin:10px auto 25px;font-size:0.95rem;line-height:1.5;">
      Nedan visas spelarens statistik fr√•n turneringens grundspel och slutspel √∂ver flera upplagor av Svenska eHockey Cupen.
    </p>
<div id="loader" class="loader-wrapper">
  <div class="loader"></div>
</div>

<div id="statsOutput"></div>

    <div id="statsOutput"></div>
  </div>

  <script>
    const API_BASE = "https://script.google.com/macros/s/AKfycbwUvylvIbUTy4_zihW5_OKIsQME2vxcPHWLldObZI28dggqJytvF2UmdsAD4Ib5Zre1/exec";

    const urlParams = new URLSearchParams(window.location.search);
    const rawName = (urlParams.get("player") || "").trim();
    const playerNameEl = document.getElementById("playerName");

    playerNameEl.textContent = rawName || "Ingen spelare vald";

    // Normalisering av namn f√∂r att matcha i foton-arket
    function norm(s) {
      return String(s || "")
        .toLowerCase()
        .replace(/[,]/g, "")
        .replace(/\s+/g, "")
        .replace(/_swe|swe|fin|nor|den|ger/g, "")
        .replace(/[^a-z0-9_]/g, "");
    }

    // Ladda spelarens foto fr√•n Google Sheets / Drive
    async function loadPhoto() {
      try {
        const res = await fetch(`${API_BASE}?sheet=${encodeURIComponent("Spelarfoton")}`);
        const rows = await res.json();

        const target = norm(rawName);
        const match = rows.find(r => norm(r.Spelarnamn || r.Namn || r.PLAYER) === target);

        const fallbackId = "1VAa79pJ-QbyeliY60autf914z6SBwmhp"; // default-bild
        const driveId = match ? (match.DriveID || match.Foto || match.Bild) : fallbackId;

        const img = document.getElementById("playerPhoto");
        img.src = `https://drive.google.com/thumbnail?id=${driveId}&sz=w1000`;
        img.onload = () => img.classList.add("loaded");
      } catch (err) {
        console.error("Foto-fel:", err);
      }
    }

    // Ladda spelarens statistik och rendera tabell som p√• Dobby-bilden
   async function loadStats() {
  const out = document.getElementById("statsOutput");
  const loader = document.getElementById("loader");

  if (!rawName) {
    out.innerHTML = `<div class="no-stats">‚ùå Ingen spelare vald i URL:en (?player=)</div>`;
    return;
  }

  // VISA LOADER
  loader.style.display = "flex";
  out.innerHTML = "";

  try {
    const res = await fetch(`${API_BASE}?player=${encodeURIComponent(rawName)}`);
    let data = await res.json();

    if (data && data.error) {
      loader.style.display = "none";
      out.innerHTML = `<div class="no-stats">‚ùå ${data.error}</div>`;
      return;
    }

    if (!Array.isArray(data)) data = [data];

    const first = data[0];
    const isGoalie = "SA" in first && "SV" in first;

    let html = `
      <div class="stats-table">
        <table>
          <thead>
    `;

    if (isGoalie) {
      html += `
        <tr>
          <th>TURNERING</th><th>TEAM</th><th>GP</th><th>SA</th><th>GA</th>
          <th>SV</th><th>GAA</th><th>SVP</th><th>SO</th>
        </tr>`;
    } else {
      html += `
        <tr>
          <th>TURNERING</th><th>TEAM</th><th>GP</th><th>G</th><th>A</th>
          <th>PTS</th><th>PIM</th>
        </tr>`;
    }

    html += `</thead><tbody>`;

    data.forEach(row => {
      const t = row.TURNERING || "‚Äî";

      if (isGoalie) {
        html += `
          <tr>
            <td>${t}</td><td>${row.TEAM}</td><td>${row.GP}</td><td>${row.SA}</td>
            <td>${row.GA}</td><td>${row.SV}</td><td>${row.GAA}</td><td>${row.SVP}</td><td>${row.SO}</td>
          </tr>`;
      } else {
        html += `
          <tr>
            <td>${t}</td><td>${row.TEAM}</td><td>${row.GP}</td><td>${row.G}</td>
            <td>${row.A}</td><td>${row.PTS}</td><td>${row.PIM}</td>
          </tr>`;
      }
    });

    html += `</tbody></table></div>`;

    out.innerHTML = html;

  } catch (err) {
    out.innerHTML = `<div class="no-stats">‚ö†Ô∏è Fel vid h√§mtning av statistik</div>`;
  }

  // D√ñLJ LOADER N√ÑR KLART
  loader.style.display = "none";
}



    // Starta
    loadPhoto();
    loadStats();
  </script>

</body>
</html>
